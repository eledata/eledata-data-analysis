{
    "contents" : "# 判别分析\n# 1.1 判别分析概念\n# 判别分析，以判别个体所属群体的一种统计方法。\n# 判别分析的假设： 1. 每个判别变量不能是其他判别变量的线性组合，不存在多重共线性的情况。2. 各个判别变量具有多远正态分布\n# 2.1 距离判别\n# 2.1.1 判别准则和判别函数\n# 1. 两个总体协方差相同\n# w(x) = (x - mu)^T S^(-1)(mu1-mu2) -- 距离判别函数\n# 判别准则： R1 = {x|w(x) >= 0} R2 = {x|w(x) < 0}\n# 具体算法里面，就是通过马氏距离的大小来判别\n# 2. 两个总体协方差不同\n# w(x) = (x - mu1)^T S1^(-1)(x-mu1) - (x - mu2)^T S2^(-1)(x-mu2)-- 距离判别函数\n# 判别准则： R1 = {x|w(x) >= 0} R2 = {x|w(x) < 0}\n# 具体算法里面，就是通过马氏距离的大小来判别\n\n# > a <- c(1,2,3,4)\n# > as.matrix(a)\n# [,1]\n# [1,]    1\n# [2,]    2\n# [3,]    3\n# [4,]    4\n# > t(as.matrix(a))\n# [,1] [,2] [,3] [,4]\n# [1,]    1    2    3    4\n\n# test data:\nclassX1<-data.frame(\n  x1=c(6.60,  6.60,  6.10,  6.10,  8.40,  7.2,   8.40,  7.50,  \n       7.50,  8.30,  7.80,  7.80),\n  x2=c(39.00, 39.00, 47.00, 47.00, 32.00,  6.0, 113.00, 52.00,\n       52.00,113.00,172.00,172.00),\n  x3=c(1.00,  1.00,  1.00,  1.00,  2.00,  1.0,   3.50,  1.00,\n       3.50,  0.00,  1.00,  1.50),\n  x4=c(6.00,  6.00,  6.00,  6.00,  7.50,  7.0,   6.00,  6.00,\n       7.50,  7.50,  3.50,  3.00),\n  x5=c(6.00, 12.00,  6.00, 12.00, 19.00, 28.0,  18.00, 12.00,\n       6.00, 35.00, 14.00, 15.00),\n  x6=c(0.12,  0.12,  0.08,  0.08,  0.35,  0.3,   0.15,  0.16,\n       0.16,  0.12,  0.21,  0.21),\n  x7=c(20.00, 20.00, 12.00, 12.00, 75.00, 30.0,  75.00, 40.00,\n       40.00,180.00, 45.00, 45.00)\n)\nclassX2<-data.frame(\n  x1=c(8.40,  8.40,  8.40,  6.3, 7.00,  7.00,  7.00,  8.30,\n       8.30,   7.2,   7.2,  7.2, 5.50,  8.40,  8.40,  7.50,\n       7.50,  8.30,  8.30, 8.30, 8.30,  7.80,  7.80),\n  x2=c(32.0 ,32.00, 32.00, 11.0, 8.00,  8.00,  8.00, 161.00,\n       161.0,   6.0,   6.0,  6.0, 6.00,113.00,113.00,  52.00,\n       52.00, 97.00, 97.00,89.00,56.00,172.00,283.00),\n  x3=c(1.00,  2.00,  2.50,  4.5, 4.50,  6.00,  1.50,  1.50,\n       0.50,   3.5,   1.0,  1.0, 2.50,  3.50,  3.50,  1.00,\n       1.00,  0.00,  2.50, 0.00, 1.50,  1.00,  1.00),\n  x4=c(5.00,  9.00,  4.00,  7.5, 4.50,  7.50,  6.00,  4.00,\n       2.50,   4.0,   3.0,  6.0, 3.00,  4.50,  4.50,  6.00,\n       7.50,  6.00,  6.00, 6.00, 6.00,  3.50,  4.50),\n  x5=c(4.00, 10.00, 10.00,  3.0, 9.00,  4.00,  1.00,  4.00,\n       1.00,  12.0,   3.0,  5.0, 7.00,  6.00,  8.00,  6.00,\n       8.00,  5.00,  5.00,10.00,13.00,  6.00,  6.00),\n  x6=c(0.35,  0.35,  0.35,  0.2, 0.25,  0.25,  0.25,  0.08,\n       0.08,  0.30,   0.3,  0.3, 0.18,  0.15,  0.15,  0.16,\n       0.16,  0.15,  0.15, 0.16, 0.25,  0.21,  0.18),\n  x7=c(75.00, 75.00, 75.00,  15.0, 30.00, 30.00, 30.00, 70.00,\n       70.00,  30.0,  30.0,  30.0, 18.00, 75.00, 75.00, 40.00,\n       40.00,180.00,180.00,180.00,180.00, 45.00, 45.00)\n)\n\ndiscriminant.dist <- function(x1, x2, test = NULL, var.equal = FALSE){\n  if(is.null(test)) test <- rbind(x1, x2)\n  if(is.vector(test)){\n    test <- t(as.matrix(test)) # 由于as.matrix()将向量转换为矩阵，会导致生成许多样本。需要t来转置，一个向量对应一个样本。\n  }else if(is.matrix(test) != TRUE){\n    test <- as.matrix(test)\n  }\n  \n  if(is.matrix(x1)) x1 <- as.matrix(x1)\n  if(is.matrix(x2)) x2 <- as.matrix(x2)\n  \n  mu1 <- colMeans(x1)\n  mu2 <- colMeans(x2)\n  \n  nt <- nrow(test) # 表示要测距的向量个数(行数)\n  result <- matrix(rep(0, nt), nrow = 1, byrow = TRUE, dimnames = list(\"result\", 1:nt))\n  \n  if(var.equal){\n    S <- cov(rbind(x1, x2))\n    compare <- mahalanobis(test, colMeans(tx1), S) - mahalanobis(test, colMeans(tx2), S)\n  }else{\n    S1 <- cov(x1)\n    S2 <- cov(x2)\n    compare <- mahalanobis(test, colMeans(tx1), S1) - mahalanobis(test, colMeans(tx2), S2)\n  }\n  \n  for(i in 1:nt){\n    if(compare[i] > 0){\n      result[i] <- 2\n    }else{\n      result[i] <- 1\n    }\n  }\n  result\n}\n\n# test:\n(discriminant.dist(classX1, classX2))\n\n(discriminant.dist(classX1, classX2, var.equal = TRUE))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1465218265190.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1713370230",
    "id" : "7B8DE584",
    "lastKnownWriteTime" : 1465219878,
    "path" : "~/GitHub/eledata-data-analysis/R-data-analysis/R Stats and Model/Discriminant_Analysis.R",
    "project_path" : "R Stats and Model/Discriminant_Analysis.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}