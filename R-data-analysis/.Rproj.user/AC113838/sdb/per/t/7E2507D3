{
    "contents" : "library(maps)\nlibrary(ggplot2)\n\nUSA.POP <- ggplot(us.cities, aes(x = long, y = lat)) + \n  xlim(-130, -65) +\n  borders(\"state\", size=0.5) + # 画出美国州地图\n  geom_point(aes(size = log(pop), color = factor(capital), alpha = 1/50)) + # 画出人口对数数据，用点来表示\n  scale_size(range=c(0, 7), name = \"log(City population)\") +\n  scale_color_manual(values = c(\"black\", \"red\"), labels = c(\"state capital\", \"city\")) +\n  guides(color = guide_legend(title=NULL)) + \n  scale_alpha(guide = FALSE) +\n  labs(x = \"longtitude\", y = \"latitude\", title = \"City Population in the United States\") +\n  theme(plot.title = element_text(size=20))\n\nUSA.POP\n#输出图像 并用cairo包进行抗锯齿处理\nggsave(USA.POP, file = \"USA_POP.png\", type = \"cairo\", width = 10, height = 6.75)\n\n\n\n\n\n\nif (require(\"maps\")) {\n  \n  ia <- map_data(\"county\", \"iowa\")\n  mid_range <- function(x) mean(range(x))\n  seats <- plyr::ddply(ia, \"subregion\", plyr::colwise(mid_range, c(\"lat\", \"long\")))\n  ggplot(ia, aes(long, lat)) +\n    geom_polygon(aes(group = group), fill = NA, colour = \"grey60\") +\n    geom_text(aes(label = subregion), data = seats, size = 2, angle = 45)\n  \n  data(us.cities)\n  capitals <- subset(us.cities, capital == 2)\n  ggplot(capitals, aes(long, lat)) +\n    borders(\"state\") +\n    geom_point(aes(size = pop)) +\n    scale_size_area() +\n    coord_quickmap()\n  \n  # Same map, with some world context\n  ggplot(capitals, aes(long, lat)) +\n    borders(\"world\", xlim = c(-130, -60), ylim = c(20, 50)) +\n    geom_point(aes(size = pop)) +\n    scale_size_area() +\n    coord_quickmap()\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconc <- c(2.856829, 5.005303, 7.519473, 22.101664, 27.769976, 39.198025, 45.483269, 203.784238)\nrate <- c(14.58342, 24.74123, 31.34551, 72.96985, 77.50099, 96.08794, 96.96624, 108.88374)\nL.minor <- data.frame(conc, rate)\nL.minor.m1 <- nls(rate ~ Vm * conc/(K + conc), data = L.minor, #采用M-M动力学方程\n                  start = list(K = 20, Vm = 120), #初始值设置为K=20，Vm=120\n                  trace = TRUE) #占线拟合过程\n#确定x轴范围并构建数据集\nmin <- range(L.minor$conc)[1]\nmax <- range(L.minor$conc)[2]\nline.data <- data.frame(conc = seq(min, max, length.out = 1000))\n#用模型预测数据构建数据集\nline.data$p.predict <- predict(L.minor.m1, newdata = line.data)\n\nrequire(ggplot2)\nM_Mfunction <- ggplot() +\n  geom_point(aes(x = conc, y = rate), data = L.minor,\n             alpha = 0.5, size = 5, color = \"red\") +\n  geom_line(aes(x = conc, y = p.predict), data = line.data,\n            size = 1, color = \"blue\") +\n  scale_x_continuous(\n    name = expression(Substrate ~~ concentration(mmol ~~ m^3)),#采用expression来表示数学公式\n    breaks = seq(0, 200, by = 25)) +\n  scale_y_continuous(\n    name = \"Uptake rate (weight/h)\",\n    breaks = seq(0, 120, by = 10)) +\n  geom_text(aes(x = 100, y = 60),\n            label = \"bolditalic(f(list(x, (list(K, V[m])))) == frac(V[m]%.%x, K+x))\",\n            #注意 geom_text中如果用expression()来进行表达，必须开启parse = TRUE\n            #同时以字符串\"\"的形式表示，不能使用expression\n            parse = TRUE, \n            size = 5, family = \"times\"\n  ) +\n  theme_bw() +\n  theme(\n    axis.title.x=element_text(size=16),\n    axis.title.y=element_text(size=16),\n    axis.text.x=element_text(size=12),\n    axis.text.y=element_text(size=12))\nM_Mfunction\n\n\n\n\n\n#showtext\nrequire(showtext)\nrequire(ggplot2)\nrequire(Cairo)\nfont.add(\"BlackoakStd\", \"C://Windows//Fonts//BlackoakStd.otf\")\nfont.add(\"BrushScriptStd\", \"C://Windows//Fonts//BrushScriptStd.otf\")\nfont.add(\"times\", \"C://Windows//Fonts//times.ttf\")\nfont.add(\"STHUPO\", \"C://Windows//Fonts//STHUPO.ttf\")\nCairoPDF(\"showtext_output\", 8, 8)\nshowtext.begin()\nggplot() +\n  geom_text(aes(x = 16, y = 16.25), label = \"Blackoak Std\", size = 8, \n            family = \"BlackoakStd\") +\n  geom_text(aes(x = 16, y = 16), label =\"Brush Script Std\", size = 16,\n            family = \"BrushScriptStd\") +\n  geom_text(aes(x = 16, y = 15.75), label = \"Times New Roman\", size = 16,\n            family = \"times\") +\n  geom_text(aes(x = 16, y = 15.50), label = \"华文琥珀\", size = 16,\n            family = \"STHUPO\") +\n  ylim(c(15.25, 16.50)) +\n  labs(x = \"\", y = \"\") +\n  theme_bw() #在用RStudio输出\nhttp://docs.ggplot2.org/current/index.html\n\n",
    "created" : 1464231632350.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2241102585",
    "id" : "7E2507D3",
    "lastKnownWriteTime" : 1464602046,
    "path" : "~/GitHub/eledata-data-analysis/R ggplot2/ggplot_map.R",
    "project_path" : "R ggplot2/ggplot_map.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}