{
    "contents" : "# 聚类分析\n# 1.1 层次聚类\n# 1.1.1 凝聚层次聚类： 从点个体开始，每一步合并两个最近的簇。时间：O(m^2 log(m)) 空间: O(m^2)\n# 基本算法：\n# repeat\n#   合并最接近的两个簇\n#   更新邻近性矩阵，以反映新的簇和原来的之间的邻近性\n# until 仅剩下一个簇\n\nlibrary(\"cluster\")\n\nX<-data.frame(\n  x1=c(2959.19, 2459.77, 1495.63, 1046.33, 1303.97, 1730.84, \n       1561.86, 1410.11, 3712.31, 2207.58, 2629.16, 1844.78, \n       2709.46, 1563.78, 1675.75, 1427.65, 1783.43, 1942.23, \n       3055.17, 2033.87, 2057.86, 2303.29, 1974.28, 1673.82, \n       2194.25, 2646.61, 1472.95, 1525.57, 1654.69, 1375.46, \n       1608.82), \n  x2=c(730.79, 495.47, 515.90, 477.77, 524.29, 553.90, 492.42, \n       510.71, 550.74, 449.37, 557.32, 430.29, 428.11, 303.65, \n       613.32, 431.79, 511.88, 512.27, 353.23, 300.82, 186.44, \n       589.99, 507.76, 437.75, 537.01, 839.70, 390.89, 472.98, \n       437.77, 480.99, 536.05),\n  x3=c(749.41, 697.33, 362.37, 290.15, 254.83, 246.91, 200.49, \n       211.88, 893.37, 572.40, 689.73, 271.28, 334.12, 233.81, \n       550.71, 288.55, 282.84, 401.39, 564.56, 338.65, 202.72, \n       516.21, 344.79, 461.61, 369.07, 204.44, 447.95, 328.90, \n       258.78, 273.84, 432.46), \n  x4=c(513.34, 302.87, 285.32, 208.57, 192.17, 279.81, 218.36, \n       277.11, 346.93, 211.92, 435.69, 126.33, 160.77, 107.90, \n       219.79, 208.14, 201.01, 206.06, 356.27, 157.78, 171.79, \n       236.55, 203.21, 153.32, 249.54, 209.11, 259.51, 219.86, \n       303.00, 317.32, 235.82),\n  x5=c(467.87, 284.19, 272.95, 201.50, 249.81, 239.18, 220.69, \n       224.65, 527.00, 302.09, 514.66, 250.56, 405.14, 209.70, \n       272.59, 217.00, 237.60, 321.29, 811.88, 329.06, 329.65, \n       403.92, 240.24, 254.66, 290.84, 379.30, 230.61, 206.65, \n       244.93, 251.08, 250.28),\n  x6=c(1141.82, 735.97, 540.58, 414.72, 463.09, 445.20, 459.62, \n       376.82, 1034.98, 585.23, 795.87, 513.18, 461.67, 393.99, \n       599.43, 337.76, 617.74, 697.22, 873.06, 621.74, 477.17, \n       730.05, 575.10, 445.59, 561.91, 371.04, 490.90, 449.69, \n       479.53, 424.75, 541.30),\n  x7=c(478.42, 570.84, 364.91, 281.84, 287.87, 330.24, 360.48, \n       317.61, 720.33, 429.77, 575.76, 314.00, 535.13, 509.39, \n       371.62, 421.31, 523.52, 492.60, 1082.82, 587.02, 312.93, \n       438.41, 430.36, 346.11, 407.70, 269.59, 469.10, 249.66, \n       288.56, 228.73, 344.85),\n  x8=c(457.64, 305.08, 188.63, 212.10, 192.96, 163.86, 147.76, \n       152.85, 462.03, 252.54, 323.36, 151.39, 232.29, 160.12, \n       211.84, 165.32, 182.52, 226.45, 420.81, 218.27, 279.19, \n       225.80, 223.46, 191.48, 330.95, 389.33, 191.34, 228.19, \n       236.51, 195.93, 214.40),\n  row.names = c(\"北京\", \"天津\", \"河北\", \"山西\", \"内蒙古\", \"辽宁\", \"吉林\", \n                \"黑龙江\", \"上海\", \"江苏\", \"浙江\", \"安徽\", \"福建\", \"江西\", \n                \"山东\",  \"河南\", \"湖北\", \"湖南\", \"广东\", \"广西\", \"海南\", \n                \"重庆\", \"四川\", \"贵州\", \"云南\", \"西藏\", \"陕西\", \"甘肃\", \n                \"青海\", \"宁夏\", \"新疆\")\n)\n\nscale.x <- scale(X)\nagn.avg <- agnes(scale.x, method = \"average\") # average linkage\nagn.sig <- agnes(scale.x, method = \"single\") # single linkage\nagn.comp <- agnes(scale.x, method = \"complete\") # complete linkage\nagn.ward <- agnes(scale.x, method = \"ward\") # ward method\nagn.weighted <- agnes(scale.x, method = \"weighted\") # weighted average linkage\nagn.flex <- agnes(X, method = \"flexible\", par.meth = 0.25) # L-W \nagn.gavg <- agnes(scale.x, method = \"gaverage\") # average\n\nopar <- par(mfrow = c(3,3))\nplot(agn.avg, hang = -1)\nplot(agn.sig, hang = -1)\nplot(agn.comp, hang = -1)\nplot(agn.ward, hang = -1)\nplot(agn.weighted, hang = -1)\nplot(agn.flex, hang = -1)\nplot(agn.gavg, hang = -1)\npar(opar)\n\n# 1.1.2 分裂层次聚类： 包含所有点的某簇开始，每一步分裂一个簇，直到剩下单点簇。\n\n\ndiana.avg <- diana(scale.x) \n\nplot(diana.avg)\n\n\n\n\n\n\n",
    "created" : 1466059011792.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "263591259",
    "id" : "AFE7B29A",
    "lastKnownWriteTime" : 1465811677,
    "path" : "~/GitHub/eledata-data-analysis/R-data-analysis/R Stats and Model/Cluster_Analysis.R",
    "project_path" : "R Stats and Model/Cluster_Analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}