{
    "contents" : "library(\"ggplot2\")\n\nset.seed(1000)\ndsmall <- diamonds[sample(nrow(diamonds),100),]\n\n\n# 1 qplot basic\n\nqplot(carat, price, data = diamonds)\n\nqplot(log(carat),log(price), data = diamonds)\n\nqplot(carat, x*y*z, data = diamonds)\n\nqplot(carat, price, data = dsmall, colour = color)\n\nqplot(carat, price, data = dsmall, shape = cut)\n\n# 调节alpha值，看数据重叠的情况\nqplot(carat, price, data = diamonds, alpha = I(1/10))\nqplot(carat, price, data = diamonds, alpha = I(1/100))\nqplot(carat, price, data = diamonds, alpha = I(1/200))\nqplot(carat, price, data = diamonds, alpha = I(1/500))\n\n# 2 几何对象 geom\n\n# 几何对象用集合传入geom\nqplot(carat, price, data = dsmall, geom = c(\"point\",\"smooth\"))\nqplot(carat, data = diamonds, geom = c(\"histogram\"))\n\np <- qplot(displ,hwy, data = mpg, colour = factor(cyl))\np\nsummary(p)\n\n\np <- ggplot(mtcars)\nsummary(p)\n\np <- p + aes(wt, hp)\np <- p + geom_point()\np\nsummary(p)\n\n\np <- p + geom_point(aes(colour = \"darkblue\"))\np\np <- p + geom_point(aes(y = disp))\np\n\nlibrary(nlme)\n\nq <- ggplot(Oxboys, aes(age, height, group = Subject)) + geom_line()\nq <- q + geom_smooth(aes(group = Subject), method = \"lm\", se = F)\nq\n\nq <- q + geom_smooth(aes(group = 1), method = \"lm\", size = 2, se = F)\nq\nboybox <- ggplot(Oxboys, aes(Occasion, height)) + geom_boxplot()\nboybox\n\nboybox <- boybox + geom_line(aes(group = Subject), colour = \"#3366FF\")\nboybox\n\nd <- ggplot(diamonds, aes(carat)) + xlim(0,3)\n\nd + stat_bin(aes(ymax = ..count..), binwidth = 0.1, geom = \"area\")\n\nd + stat_bin(aes(size = ..density..), binwidth = 0.1, geom = \"point\", position = \"identity\")\n\nd + stat_bin(\n  aes(y = 1, fill = ..count..), binwidth = 0.1,\n  geom = \"tile\", position=\"identity\")\n\n\n\ntest.df <- data.frame(\n    x = c(3,1,5),\n    y = c(2,4,6),\n    label = c(\"a\",\"b\", \"c\")\n  )\n\ntest.p <- ggplot(test.df, aes(x,y)) + xlab(NULL) + ylab(NULL)\ntest.p + geom_point() + labs(title = \"geom_point\")\ntest.p + geom_bar(stat = \"identity\") + labs(title = \"geom_bar(stat = \\\"identity\\\")\")\ntest.p + geom_line() + labs(title = \"geom_line\")\ntest.p + geom_area() + labs(title = \"geom_area\")\ntest.p + geom_path() + labs(title = \"geom_path\")\ntest.p + geom_text(aes(label = label)) + labs(title = \"geom_text\")\ntest.p + geom_tile() + labs(title = \"geom_tile\")\ntest.p + geom_polygon() + labs(title = \"geom_polygon\")\n\n\n\n# 展示数据分布\n\ndepth_dist <- ggplot(diamonds, aes(depth)) + xlim(58,68)\n# 直方图, 用了分面对比\ndepth_dist + geom_histogram(aes(y = ..density.., colour = cut), binwidth = 0.1) + facet_grid(cut ~ .)\n# 条件密度图\ndepth_dist + geom_histogram(aes(fill = cut), binwidth = 0.1, position = \"fill\")\n# 频率多边形图\ndepth_dist + geom_freqpoly(aes(y = ..density.., colour = cut), binwidth = 0.1)\n\n\n\nlibrary(plyr)\nqplot(cut, depth, data = diamonds, geom = \"boxplot\")\nqplot(carat, depth, data = diamonds, geom = \"boxplot\", group = round_any(carat, 0.1, floor), xlim = c(0,3))\n\nqplot(class, cty, data = mpg, geom = \"jitter\")\n\nqplot(depth, data=diamonds, geom=\"density\", xlim = c(54, 70))\nqplot(depth, data=diamonds, geom=\"density\", xlim = c(54, 70),\n      fill = cut, alpha = I(0.2))\n\n\n\n# 处理掩盖问题\n\ntest.data <- data.frame(\n  x = rnorm(2000),\n  y = rnorm(2000)\n  )\ntest.data\nnorm <- ggplot(test.data, aes(x,y))\nnorm + geom_point()\nnorm + geom_point(shape = 1) # 中空的点\nnorm + geom_point(shape = \".\") # 点的大小为像素级别\n\n# alpha 分母表示一个位置的颜色完全变为不透明时，所需要重叠点的数量\nnorm + geom_point(colour = \"black\", alpha = 1/3) \nnorm + geom_point(colour = \"black\", alpha = 1/5)\nnorm + geom_point(colour = \"black\", alpha = 1/10)\n\ntd <- ggplot(diamonds, aes(table, depth)) +\n  xlim(50, 70) + ylim(50, 70)\ntd + geom_point()\ntd + geom_jitter()\njit <- position_jitter(width = 0.5)\ntd + geom_jitter(position = jit)\ntd + geom_jitter(position = jit, colour = alpha(\"black\", 1/10))\ntd + geom_jitter(position = jit, colour = alpha(\"black\", 1/50))\ntd + geom_jitter(position = jit, colour = alpha(\"black\", 1/200))\n\n\n\n\n# Chap 6\n\nplot <- qplot(cty, hwy, data = mpg)\nplot\n\nplot + aes(x = drv)\n\nplot + aes(x = drv) + scale_x_discrete()\n\n\np <- qplot(sleep_total, sleep_cycle, data = msleep, colour = vore)\np\n# Explicitly add the default scale\np + scale_colour_hue()\n# Adjust parameters of the default, here changing the appearance\n# of the legend\np + scale_colour_hue(\"What does\\nit eat?\",\n                     breaks = c(\"herbi\", \"carni\", \"omni\", NA),\n                     labels = c(\"plants\", \"meat\", \"both\", \"don’t know\"))\n# Use a different scale\np + scale_colour_brewer(palette = \"Set1\")\n\n\n\np <- qplot(cty, hwy, data = mpg, colour = displ)\np\np + scale_x_continuous(\"City mpg\")\np + xlab(\"City mpg\") # x 坐标轴名称换成City mpg\np + ylab(\"Highway mpg\") # y 坐标轴名称\np + labs(x = \"City mpg\", y = \"Highway\", colour = \"Displacement\") # 同时开始换\np + xlab(expression(frac(miles, gallon)))\n\n\n\n\n\n\np <- qplot(cyl, wt, data = mtcars)\np\np + scale_x_continuous(breaks = c(5.5, 6.5))\np + scale_x_continuous(limits = c(5.5, 6.5))\np <- qplot(wt, cyl, data = mtcars, colour = cyl)\np\np + scale_colour_gradient(breaks = c(5.5, 6.5))\np + scale_colour_gradient(limits = c(5.5, 6.5))\n\n\nqplot(log10(carat), log10(price), data = diamonds)\nqplot(carat, price, data = diamonds) + scale_x_log10() + scale_y_log10()\n\nplot <- ggplot(data = economics, aes(date, psavert)) + geom_line() + geom_hline(xintercept = 0, colour = \"grey50\")\nplot\n+ ylab(\"Personal savings rate\") + geom_hline(xintercept = 0, colour = \"grey50\")\nplot\nplot + scale_x_date(major = \"10 years\")\nplot + scale_x_date(\n  limits = as.Date(c(\"2004-01-01\", \"2005-01-01\")),\n  format = \"%Y-%m-%d\"\n)\n\n\n# 颜色渐变，从浓变淡\npoint <- qplot(brainwt, bodywt, data = msleep, log = \"xy\",\n               colour = vore)\narea <- qplot(log10(brainwt), data = msleep, fill = vore,\n              binwidth = 1)\npoint + scale_colour_brewer(palette = \"Set1\")\npoint + scale_colour_brewer(palette = \"Set2\")\npoint + scale_colour_brewer(palette = \"Pastel1\")\narea + scale_fill_brewer(palette = \"Set1\")\narea + scale_fill_brewer(palette = \"Set2\")\narea + scale_fill_brewer(palette = \"Pastel1\")\n\n\n\n\n\nplot <- qplot(brainwt, bodywt, data = msleep, log = \"xy\")\nplot + aes(colour = vore) +\n  scale_colour_manual(values = c(\"red\", \"orange\", \"yellow\",\n                                \"green\", \"blue\"))\ncolours <- c(carni = \"red\", \"NA\" = \"orange\", insecti = \"yellow\",herbi = \"green\", omni = \"blue\")\nplot + aes(colour = vore) + scale_colour_manual(values = colours)\nplot + aes(shape = vore) +\n  scale_shape_manual(values = c(1, 2, 6, 0, 23))\n\n\n\nhuron <- data.frame(year = 1875:1972, level = LakeHuron)\nhuron\nggplot(huron, aes(year)) + \n  geom_line(aes(y = level - 5), colour = \"blue\") + \n  geom_line(aes(y = level + 5), colour = \"red\") + \n  scale_colour_manual(\"Direction\", values = c(\"below\" = \"blue\", \"above\" = \"red\"))\n\n\n             \n# Chap 7\n\nmpg2 <- subset(mpg, cyl != 5&drv %in% c(\"4\",\"f\"))\nmpg2\n\nqplot(cty, hwy, data = mpg2)\n\n# 一行多列\nqplot(cty, hwy, data = mpg2) + facet_grid(.~cyl)\n# 一列多行\nqplot(cty, hwy, data = mpg2) + facet_grid(cyl~.)\n\n# 多行多列\nqplot(cty, hwy, data = mpg2) + facet_grid(drv~cyl)\n\n\n\n# 电影 10 年评分分布\ndata(movies)\nmovies$decade <- round_any(movies$year, 10, floor)\nqplot(rating, ..density.., data=subset(movies, decade > 1890),\n      geom=\"histogram\", binwidth = 0.5) +\n  facet_wrap(~ decade, ncol = 6)\n\n\n\n\n             \n             ",
    "created" : 1464166468689.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "128296462",
    "id" : "97E81CD1",
    "lastKnownWriteTime" : 1464579065,
    "path" : "~/GitHub/eledata-data-analysis/R ggplot2/ggplot2.R",
    "project_path" : "R ggplot2/ggplot2.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}